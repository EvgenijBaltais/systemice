{"version":3,"file":"components/event-form.js","sources":["webpack:///./components/event_form.vue?8363","webpack:///./components/event_form.vue","webpack:///./components/event_form.vue?fcd9","webpack:///./components/event_form.vue?6296"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"event-details\"},[_vm._ssrNode(\"<div class=\\\"details-header\\\"><div class=\\\"details-header-title\\\"><span class=\\\"details-text-span\\\">Контакты</span> <span class=\\\"details-step-span\\\">Финал</span></div> <div class=\\\"details-progress-mini\\\"><div class=\\\"details-full-filled\\\"></div></div> <form name=\\\"event_data\\\"><div class=\\\"details-body\\\"><div class=\\\"events-form\\\"><div class=\\\"events-form-div\\\"><div class=\\\"events-form-item-w\\\"><input type=\\\"text\\\" placeholder=\\\"Контактное лицо\\\" id=\\\"events-form-name\\\"\"+(_vm._ssrAttr(\"value\",(_vm.name)))+\" class=\\\"events-form-item events-form-name\\\"></div> <div class=\\\"spy-left-input\\\"></div> <div class=\\\"spy-bottom-input\\\"></div> <div class=\\\"spy-right-input\\\"></div> <div class=\\\"spy-top-input\\\"></div></div> <div class=\\\"events-form-div\\\"><div class=\\\"events-form-item-w\\\"><input type=\\\"text\\\" placeholder=\\\"Название компании\\\" id=\\\"events-form-company\\\"\"+(_vm._ssrAttr(\"value\",(_vm.company)))+\" class=\\\"events-form-item events-form-company\\\"></div> <div class=\\\"spy-left-input\\\"></div> <div class=\\\"spy-bottom-input\\\"></div> <div class=\\\"spy-right-input\\\"></div> <div class=\\\"spy-top-input\\\"></div></div> <div class=\\\"events-form-div\\\"><div class=\\\"events-form-item-w\\\"><input type=\\\"text\\\" placeholder=\\\"Телефон *\\\" id=\\\"events-form-phone\\\"\"+(_vm._ssrAttr(\"value\",(_vm.phone)))+\" class=\\\"events-form-item events-form-phone\\\"></div> <div class=\\\"spy-left-input\\\"></div> <div class=\\\"spy-bottom-input\\\"></div> <div class=\\\"spy-right-input\\\"></div> <div class=\\\"spy-top-input\\\"></div></div> <div class=\\\"events-form-div\\\"><div class=\\\"events-form-item-w\\\"><input type=\\\"text\\\" placeholder=\\\"Email\\\" id=\\\"events-form-email\\\"\"+(_vm._ssrAttr(\"value\",(_vm.email)))+\" class=\\\"events-form-item events-form-company\\\"></div> <div class=\\\"spy-left-input\\\"></div> <div class=\\\"spy-bottom-input\\\"></div> <div class=\\\"spy-right-input\\\"></div> <div class=\\\"spy-top-input\\\"></div></div> <div class=\\\"events-textarea-w\\\"><label for=\\\"events-textarea\\\" class=\\\"details-date-label\\\">Комментарий</label> <div class=\\\"events-textarea-border-w\\\"><textarea placeholder=\\\"Напишите Ваши пожелания, идеи и дополнительную информацию по мероприятию, чтобы наш менеджер смог подготовить самое выгодное предложение!\\\" name cols=\\\"30\\\" rows=\\\"10\\\" id=\\\"events-textarea\\\" class=\\\"events-textarea\\\">\"+_vm._ssrEscape(_vm._s(_vm.comment))+\"</textarea> <div class=\\\"spy-left-textarea\\\"></div> <div class=\\\"spy-bottom-textarea\\\"></div> <div class=\\\"spy-right-textarea\\\"></div> <div class=\\\"spy-top-textarea\\\"></div></div></div> <div class=\\\"events-file-block\\\"><div class=\\\"events-add-brief\\\"><input type=\\\"file\\\" name=\\\"file\\\" id=\\\"field__file\\\" multiple=\\\"multiple\\\" class=\\\"field__file-input\\\"> <label for=\\\"field__file\\\" class=\\\"field__file-wrapper\\\"><a class=\\\"add-brief\\\">Прикрепить бриф</a></label></div> <div class=\\\"go-back-to-prev\\\"><a class=\\\"go-back-span\\\">Назад</a></div> <div class=\\\"to-next-step-final\\\"><input type=\\\"submit\\\" value=\\\"Отправить\\\" class=\\\"send-button\\\"> <div class=\\\"spy-left-btn\\\"></div> <div class=\\\"spy-bottom-btn\\\"></div> <div class=\\\"spy-right-btn\\\"></div> <div class=\\\"spy-top-btn\\\"></div></div></div></div></div></form></div>\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport Inputmask from \"inputmask\"\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      siblingComponent: \"eventData\",\r\n      name: \"\",\r\n      phone: \"\",\r\n      email: \"\",\r\n      company: \"\",\r\n      comment: \"\",\r\n      formData: this.$store.state.eventForm,\r\n      sendingForm: 0,\r\n      im: new Inputmask(\"+7 (999) 999-99-99\"),\r\n    };\r\n  },\r\n  components: {},\r\n  methods: {\r\n    checkForm(e) {\r\n\r\n      let phoneField = document.querySelector(\".events-form-phone\")\r\n\r\n      if (!phoneField.inputmask.isComplete()) {\r\n        phoneField.classList.add(\"input-box-wrong\")\r\n        return false\r\n      }\r\n      this.sendForm(e.target)\r\n    },\r\n\r\n    sendForm(form) {\r\n      if (this.sendingForm != 0) return false;\r\n\r\n      this.sendingForm = 1\r\n\r\n      axios.interceptors.request.use((req) => {\r\n        form.querySelector(\".send-button\").value = \"Отправка...\";\r\n        return req;\r\n      });\r\n\r\n      let bodyFormData = new FormData(),\r\n          data = this.$store.state.eventForm\r\n\r\n        let dateKnight = ''\r\n          if (data.date) {\r\n              dateKnight = this.getKnightDate(data.date)\r\n          }\r\n\r\n      let dopinfo = 'С формы: Собрать собственное мероприятие (systemice.ru/event-progress)'\r\n\r\n\r\n      data.budget ? dopinfo += '; Бюджет: ' + data.budget : ''\r\n      data.location ? dopinfo += '; место проведения: ' + data.location : ''\r\n      dateKnight ? dopinfo += '; на дату: ' + dateKnight : ''\r\n      data.guestsNumber ? dopinfo += '; гостей: ' + data.guestsNumber : ''\r\n      data.men ? dopinfo += '; мужчин: ' + data.men : ''\r\n      data.women ? dopinfo += '; женщин: ' + data.women : ''\r\n      this.company ? dopinfo += '; компания: ' + this.company : ''\r\n      data.link ? dopinfo += '; ссылка: ' + data.link : ''\r\n      document.getElementById('#cb1') ? dopinfo += '; дата предварительная? ' + [data.dateAdvance === true ? 'Да' : 'Нет'] : ''\r\n      data.format ? dopinfo += '; формат мероприятия: ' + data.format : ''\r\n      this.comment ? dopinfo += \"; комментарий: \" + this.comment : ''\r\n\r\n      document.querySelector('#field__file').files[0] ? dopinfo += '; Файл: ' + document.querySelector('#field__file').files[0].name : ''\r\n\r\n      bodyFormData.append(\"name\", this.name)\r\n      bodyFormData.append(\"phone\", this.phone)\r\n      bodyFormData.append(\"email\", this.email)\r\n      bodyFormData.append(\"date\", dateKnight)\r\n      bodyFormData.append(\"company\", this.company)\r\n      bodyFormData.append(\"comment\", this.comment)\r\n      bodyFormData.append(\"guestsNumber\", data.guestsNumber)\r\n      bodyFormData.append(\"men\", data.men)\r\n      bodyFormData.append(\"women\", data.women)\r\n      bodyFormData.append(\"format\", data.format)\r\n      bodyFormData.append(\"budget\", data.budget)\r\n      bodyFormData.append(\"location\", data.location)\r\n      bodyFormData.append(\"link\", data.link)\r\n      bodyFormData.append(\"dateAdvance\", [data.dateAdvance === true ? 'Да' : 'Нет'])\r\n      bodyFormData.append(\"form_name\", form.getAttribute(\"name\"))\r\n      bodyFormData.append('hotel', 13632)\r\n      bodyFormData.append('dopinfo', dopinfo)\r\n      bodyFormData.append('form_name_text', 'Собрать собственное мероприятие (systemice.ru/event-progress)')\r\n      bodyFormData.append('file', document.querySelector('#field__file').files[0])\r\n\r\n      axios\r\n      .post(\"https://systemice.ru/knight_bron.php\", bodyFormData, {\r\n        headers: {\r\n          \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n        },\r\n      })\r\n      .then((response) => {\r\n        if (!response.data || response.data == \"\") {\r\n          form.querySelector(\".send-button\").value = \"Ошибка!\"\r\n          return false;\r\n        }\r\n        form.querySelector(\".send-button\").value = \"Успешно!\"\r\n\r\n        this.$metrika.reachGoal('create_event_order')\r\n      })\r\n    },\r\n\r\n    changeEventComponent(e) {\r\n      this.formData.name = this.name;\r\n      this.formData.phone = this.phone;\r\n      this.formData.email = this.email;\r\n      this.formData.company = this.company;\r\n      this.formData.comment = this.comment;\r\n\r\n      this.$store.dispatch({\r\n        type: \"changeEventData\",\r\n        data: this.formData,\r\n      });\r\n\r\n      this.$emit(\"updateStatus\", this.siblingComponent);\r\n    },\r\n    getKnightDate: function(date) {\r\n\r\n    \tvar dd = date.getDate();\r\n    \tif (dd < 10) dd = '0' + dd;\r\n\r\n    \tvar mm = date.getMonth() + 1;\r\n    \tif (mm < 10) mm = '0' + mm;\r\n\r\n    \tvar yy = date.getFullYear();\r\n    \tif (yy < 10) yy = '0' + yy;\r\n\r\n    \treturn yy + '-' + mm + '-' + dd;\r\n    },\r\n    getParent: function (el, cls) {\r\n      while ((el = el.parentElement) && !el.classList.contains(cls));\r\n      return el;\r\n    },\r\n  },\r\n  mounted() {\r\n    // Если пользователь уже заполнил эту форму и возвращается со следующей то заполнить поля готовыми данными\r\n\r\n    let readyValues = this.$store.state.eventForm;\r\n\r\n    readyValues.name ? (this.name = readyValues.name) : \"\";\r\n    readyValues.company ? (this.company = readyValues.company) : \"\";\r\n    readyValues.phone ? (this.phone = readyValues.phone) : \"\";\r\n    readyValues.email ? (this.email = readyValues.email) : \"\";\r\n    readyValues.comment ? (this.comment = readyValues.comment) : \"\";\r\n\r\n    // Обнуление стилей неверно заполненных полей\r\n\r\n    let phoneField = document.querySelector(\".events-form-phone\"),\r\n    nameField = document.querySelector(\".events-form-name\");\r\n\r\n    phoneField.addEventListener(\"keyup\", function () {\r\n      this.classList.remove(\"input-box-wrong\");\r\n    });\r\n\r\n    phoneField.addEventListener(\"focus\", function () {\r\n      this.classList.remove(\"input-box-wrong\");\r\n    });\r\n\r\n    nameField.addEventListener(\"keyup\", function () {\r\n      this.classList.remove(\"input-box-wrong\");\r\n    });\r\n\r\n    nameField.addEventListener(\"focus\", function () {\r\n      this.classList.remove(\"input-box-wrong\");\r\n    });\r\n\r\n    // Маска телефона\r\n\r\n    this.im.mask(phoneField)\r\n\r\n  }\r\n};\r\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./event_form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./event_form.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./event_form.vue?vue&type=template&id=209a3810&\"\nimport script from \"./event_form.vue?vue&type=script&lang=js&\"\nexport * from \"./event_form.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  \"31c75368\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;;;;;AAAA;AACA;AACA;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAWA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AADA;AADA;AAMA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAFA;AAKA;AACA;AACA;AAAA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AAlHA;AACA;AAmHA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAGA;AAAA;AAGA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAGA;AAEA;AACA;AAxKA;;ACnIA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}